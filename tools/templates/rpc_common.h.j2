/* Auto-generated by UVRPC DSL Generator */
#ifndef {{ namespace|upper }}_{{ service_name_upper }}_RPC_COMMON_H
#define {{ namespace|upper }}_{{ service_name_upper }}_RPC_COMMON_H

#include "{{ namespace|lower }}_builder.h"
#include "{{ namespace|lower }}_reader.h"
#include "../include/uvrpc.h"
#include "../include/uvrpc_async.h"

#ifdef __cplusplus
extern "C" {
#endif

/* Async utility function declarations */
{% for method in service.methods -%}

/**
 * Execute multiple {{ method.name }} calls concurrently and wait for all to complete (Promise.all)
 * @param ctx async context
 * @param clients array of RPC clients
 * @param requests array of request tables
 * @param results output array of response tables (caller must free each result)
 * @param count number of calls
 * @param timeout_ms timeout in milliseconds (0 for no timeout)
 * @return UVRPC_OK on success, UVRPC_ERROR_TIMEOUT on timeout
 */
uvrpc_error_t uvrpc_{{ service_name_lower }}_{{ method.name|lower }}_all(
    uvrpc_async_ctx_t* ctx,
    uvrpc_client_t** clients,
    const {{ namespace }}_{{ method.request }}_table_t* requests,
    {{ namespace }}_{{ method.response }}_table_t*** results,
    int count,
    uint64_t timeout_ms);

/**
 * Execute multiple {{ method.name }} calls concurrently and wait for any to complete (Promise.any)
 * @param ctx async context
 * @param clients array of RPC clients
 * @param requests array of request tables
 * @param result output response table
 * @param completed_index index of the completed call
 * @param count number of calls
 * @param timeout_ms timeout in milliseconds (0 for no timeout)
 * @return UVRPC_OK on success, UVRPC_ERROR_TIMEOUT on timeout
 */
uvrpc_error_t uvrpc_{{ service_name_lower }}_{{ method.name|lower }}_any(
    uvrpc_async_ctx_t* ctx,
    uvrpc_client_t** clients,
    const {{ namespace }}_{{ method.request }}_table_t* requests,
    {{ namespace }}_{{ method.response }}_table_t* result,
    int* completed_index,
    int count,
    uint64_t timeout_ms);

{% endfor -%}

#ifdef __cplusplus
}
#endif

#endif /* {{ namespace|upper }}_{{ service_name_upper }}_RPC_COMMON_H */